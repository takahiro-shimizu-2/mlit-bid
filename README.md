# 国土交通省 入札案件抽出 Chrome拡張機能

国土交通省の入札情報サービスから入札案件の詳細情報を抽出し、スプレッドシート用のタブ区切り形式でクリップボードにコピーするChrome拡張機能です。

**バージョン**: 1.0.2  
**テスト状況**: ✅ 完了（2025年7月21日実施・全6パターン成功）

## 機能

- 📄 入札案件詳細ページから全情報を自動抽出
- 📋 スプレッドシート用にタブ区切り形式で整形
- ✅ ワンクリックでクリップボードにコピー
- 🚫 詳細ページ以外でのエラーハンドリング
- 🎯 シンプルな1ボタンUI

## インストール方法

### 開発版のインストール

1. このリポジトリをダウンロードまたはクローン
   ```bash
   git clone https://github.com/username/mlit-bid.git
   cd mlit-bid
   ```

2. Chromeで拡張機能ページを開く
   - アドレスバーに `chrome://extensions/` を入力
   - または、メニュー → その他のツール → 拡張機能

3. デベロッパーモードを有効にする
   - ページ右上の「デベロッパーモード」をONに切り替え

4. 拡張機能を読み込む
   - 「パッケージ化されていない拡張機能を読み込む」をクリック
   - `src` フォルダを選択

## 使い方

1. **詳細ページを開く**
   - 入札情報サービス（https://www.i-ppi.jp）にアクセス
   - 工事案件を検索し、**詳細ページ**（List_Detail.aspx）を開く
   - ⚠️ **重要**: 一覧ページでは動作しません。必ず詳細ページで実行してください

2. **データを抽出**
   - ブラウザのツールバーにある拡張機能アイコンをクリック
   - ポップアップウィンドウが表示されます
   - 「📄 入札情報を取得」ボタンをクリック
   - 成功すると「入札情報を抽出してクリップボードにコピーしました。」と表示されます

3. **スプレッドシートに貼り付け**
   - データが自動的にクリップボードにコピーされます
   - Google SheetsやExcelを開き、貼り付け（Ctrl+V / Cmd+V）

## 抽出データ形式

以下の形式でタブ区切りデータが生成されます：

| 列 | 内容 | 例 |
|---|------|-----|
| A | （空欄） | |
| B | 工事名称 | 令和6年度 国道1号線舗装修繕工事 |
| C | 設計書番号 | R06-KT-001234 |
| D | 発注機関（主要部） | 国土交通省 |
| E | 発注機関（詳細部） | 関東地方整備局 東京国道事務所 |
| F | 公告日時 | 令和6年7月1日 10時00分 |
| G | （空欄） | |
| H | 期限日時 | 令和6年7月20日 17時00分 |
| I | 開札日時 | 令和6年7月22日 10時00分 |
| J | PDF URL | https://... |
| K | （空欄） | |
| L | 工事種別 | 舗装工事 |

## 対応ページ

- **入札案件詳細ページのみ対応**: `https://www.i-ppi.jp/IPPI/SearchServices/Web/Koji/Kokoku/List_Detail.aspx*`
- ※一覧ページからの抽出には対応していません

## 技術仕様

- **Manifest Version**: 3
- **対応ブラウザ**: Google Chrome 90以上
- **使用技術**: Vanilla JavaScript, Chrome Extension APIs
- **権限**: 
  - `clipboardWrite`: クリップボードへのコピー
  - `tabs`: タブ情報の取得
  - `scripting`: コンテンツスクリプトの実行

## プロジェクト構造

```
mlit-bid/
├── src/
│   ├── manifest.json         # 拡張機能の設定ファイル
│   ├── popup/               # ポップアップUI
│   │   ├── popup.html
│   │   ├── popup.js
│   │   └── popup.css
│   ├── content/             # コンテンツスクリプト
│   │   ├── content.js       # メインコンテンツスクリプト
│   │   ├── extractor.js     # データ抽出ロジック
│   │   └── formatter.js     # データフォーマット
│   ├── background/          # バックグラウンドスクリプト
│   │   └── background.js
│   └── assets/              # アセット
│       └── icons/
└── docs/                    # ドキュメント
```

## トラブルシューティング

### 拡張機能が動作しない場合

1. **詳細ページであることを確認**
   - URLが `https://www.i-ppi.jp/IPPI/SearchServices/Web/Koji/Kokoku/List_Detail.aspx` であること
   - 一覧ページでは動作しません

2. **拡張機能の権限を確認**
   - Chrome拡張機能ページで必要な権限が許可されているか確認

3. **エラーログを確認**
   - 開発者ツール（F12）のコンソールでエラーメッセージを確認

### データが正しく抽出されない場合

- ページの読み込みが完了してから実行してください
- 入札情報サービスのページ構造が変更された可能性があります

## 注意事項

- この拡張機能は入札案件の**詳細ページ**でのみ動作します
- 一覧ページからの複数案件一括抽出には対応していません
- データの正確性について保証はありません。必ず元のページで確認してください

## 配布について

この拡張機能は内部利用専用です。外部への配布・公開は行いません。

## 免責事項

- この拡張機能は非公式のツールです
- 入札情報サービスの利用規約を遵守してご使用ください
- ページの構造が変更された場合、正しく動作しない可能性があります

## 更新履歴

### v1.0.2 (2025-07-21)
- PDF URL抽出ロジックを改善
- 「入札」を含む文書名称に対応（「入札公告」「入札の公告等」など）
- 全6パターン（岐阜県、防衛省、農林水産省、国土交通省、内閣府、市町村）でテスト成功

### v1.0.1 (2025-07-21)
- テスト完了
- 岐阜県・防衛省案件での動作確認済み
- エラーハンドリングの動作確認済み

### v1.0.0 (2025-07-21)
- 初回リリース
- 詳細ページからのデータ抽出機能
- クリップボードへのコピー機能