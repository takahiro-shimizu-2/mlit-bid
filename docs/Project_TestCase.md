# 国土交通省 入札案件抽出 Chrome拡張機能 - テストケース表

**関連ドキュメント**: Project_design.md, Project_TODO.md, Project_Test.md  
**更新日**: 2025年7月21日  
**バージョン**: 2.0

----------------------------------------------------------------

## 1. 単体テストケース

### 1.1 データ抽出機能（extractor.js）

| TC_ID | テスト項目 | 前提条件 | テスト手順 | 入力データ | 期待結果 | 優先度 |
|-------|-----------|----------|------------|------------|----------|--------|
| UT_EXT_001 | 発注機関の抽出 | DOM要素が存在 | extractData()を実行 | id="lblHachukikan"の要素 | "防衛省北関東防衛局"が取得される | High |
| UT_EXT_002 | 工事名称の抽出 | DOM要素が存在 | extractData()を実行 | id="lblKojiNm"の要素 | "下総（７）航空管制施設整備工事"が取得される | High |
| UT_EXT_003 | 設計書番号の抽出 | DOM要素が存在 | extractData()を実行 | id="lblSekkeisyoNo"の要素 | "0010040000420250155"が取得される | High |
| UT_EXT_004 | 要素が存在しない場合 | DOM要素が不在 | extractData()を実行 | 存在しないID | 空文字列が返される、エラーなし | High |
| UT_EXT_005 | 詳細ページ判定 | 必須要素なし | extractData()を実行 | 詳細ページ以外 | エラー「入札案件の詳細ページでのみ使用できます。」 | High |
| UT_EXT_006 | PDFリンクの抽出 | リンクが存在 | extractPdfUrl()を実行 | href="*.pdf"のリンク | 正しいURLが取得される | High |
| UT_EXT_007 | 相対URLの変換 | 相対パスのリンク | extractPdfUrl()を実行 | href="/path/to/file.pdf" | 絶対URLに変換される | Medium |

### 1.2 データ整形機能（formatter.js）

| TC_ID | テスト項目 | 前提条件 | テスト手順 | 入力データ | 期待結果 | 優先度 |
|-------|-----------|----------|------------|------------|----------|--------|
| UT_FMT_001 | 発注機関の分割（省） | データ抽出済み | parseOrganization()を実行 | "防衛省北関東防衛局" | D列:"防衛省"、E列:"北関東防衛局" | High |
| UT_FMT_002 | 発注機関の分割（県） | データ抽出済み | parseOrganization()を実行 | "東京都建設局" | D列:"東京都"、E列:"建設局" | High |
| UT_FMT_003 | 発注機関の分割（内閣府） | データ抽出済み | parseOrganization()を実行 | "内閣府" | D列:"内閣府"、E列:空欄 | High |
| UT_FMT_004 | 発注機関の分割（その他） | データ抽出済み | parseOrganization()を実行 | "○○建設株式会社" | D列:"○○建設株式会社"、E列:空欄 | High |
| UT_FMT_005 | タブ区切り形式変換 | データ整形済み | formatData()を実行 | 完全なデータセット | 正しい列順序でタブ区切り | High |
| UT_FMT_006 | 空データの処理 | 一部データ欠損 | formatData()を実行 | 一部nullのデータ | 空文字列として処理される | Medium |
| UT_FMT_007 | 日時フォーマット | 日時データあり | formatDateTime()を実行 | "2025年7月21日  10時00分" | スペース正規化される | Medium |

### 1.3 コンテンツスクリプト（content.js）

| TC_ID | テスト項目 | 前提条件 | テスト手順 | 入力データ | 期待結果 | 優先度 |
|-------|-----------|----------|------------|------------|----------|--------|
| UT_CNT_001 | pingメッセージ応答 | - | pingメッセージ送信 | action: 'ping' | success: trueが返される | High |
| UT_CNT_002 | 詳細ページでの抽出 | 詳細ページ | extractDataメッセージ送信 | action: 'extractData' | 整形済みデータが返される | High |
| UT_CNT_003 | 詳細ページ以外での抽出 | 一覧ページ | extractDataメッセージ送信 | action: 'extractData' | エラーメッセージが返される | High |

----------------------------------------------------------------

## 2. 統合テストケース

| TC_ID | テスト項目 | 前提条件 | テスト手順 | 入力データ | 期待結果 | 優先度 |
|-------|-----------|----------|------------|------------|----------|--------|
| IT_001 | Popup→Content通信 | 拡張機能インストール済み | 1.ポップアップを開く<br>2.抽出ボタンクリック | - | Content Scriptにメッセージ送信される | High |
| IT_002 | スクリプト存在確認 | 詳細ページ表示 | 1.拡張機能実行<br>2.ping確認 | - | スクリプトの存在が確認される | High |
| IT_003 | スクリプト注入 | スクリプト未読込 | 1.拡張機能実行<br>2.スクリプト注入 | - | 必要なスクリプトが注入される | High |
| IT_004 | クリップボードコピー | データ抽出完了 | 1.データ抽出<br>2.コピー処理 | 整形済みデータ | クリップボードにコピーされる | High |

----------------------------------------------------------------

## 3. E2Eテストケース

### 3.1 基本機能テスト

| TC_ID | テスト項目 | 前提条件 | テスト手順 | 期待結果 | 優先度 |
|-------|-----------|----------|------------|----------|--------|
| E2E_001 | 正常系：データ抽出フロー | 詳細ページ表示 | 1.拡張機能アイコンクリック<br>2.「入札情報を取得」クリック<br>3.完了確認 | データがクリップボードにコピーされる | High |
| E2E_002 | スプレッドシート貼り付け | データコピー済み | 1.スプレッドシートを開く<br>2.Ctrl+Vで貼り付け | 正しい列にデータが配置される | High |
| E2E_003 | エラーハンドリング | 非対応ページ | 1.一覧ページで実行<br>2.エラー確認 | 「入札案件の詳細ページでのみ使用できます。」が表示される | High |
| E2E_004 | 複数回実行 | 詳細ページ | 1.データ抽出実行<br>2.別の詳細ページで再実行 | 各ページのデータが正しく抽出される | Medium |

----------------------------------------------------------------

## 4. 非機能テストケース

### 4.1 パフォーマンステスト

| TC_ID | テスト項目 | 測定条件 | 測定項目 | 合格基準 | 優先度 |
|-------|-----------|----------|----------|----------|--------|
| PF_001 | 抽出処理時間 | 通常のページサイズ | 処理開始から完了まで | 3秒以内 | High |
| PF_002 | メモリ使用量 | 連続10回実行 | 最大メモリ使用量 | 50MB以下 | Medium |

### 4.2 互換性テスト

| TC_ID | テスト項目 | テスト環境 | テスト内容 | 合格基準 | 優先度 |
|-------|-----------|------------|-----------|----------|--------|
| CP_001 | Chrome 90 | Windows 10 | 全機能テスト | 正常動作 | High |
| CP_002 | Chrome 100 | Windows 11 | 全機能テスト | 正常動作 | High |
| CP_003 | Chrome最新版 | macOS 12 | 全機能テスト | 正常動作 | High |

----------------------------------------------------------------

## 5. 回帰テストケース

| TC_ID | テスト項目 | 実施タイミング | テスト範囲 | 優先度 |
|-------|-----------|---------------|-----------|--------|
| RG_001 | 基本機能確認 | 機能追加・修正後 | E2E_001～E2E_004 | High |
| RG_002 | データ整形確認 | formatter.js修正後 | UT_FMT_001～UT_FMT_007 | High |
| RG_003 | エラーハンドリング確認 | エラー処理修正後 | UT_EXT_005, E2E_003 | High |

----------------------------------------------------------------

## 6. 異常系テストケース

| TC_ID | テスト項目 | 異常条件 | テスト手順 | 期待結果 | 優先度 |
|-------|-----------|----------|------------|----------|--------|
| AB_001 | DOM構造変更 | 要素IDが変更 | データ抽出実行 | エラーメッセージ表示 | High |
| AB_002 | 権限不足 | クリップボード権限なし | コピー実行 | エラーメッセージ表示 | Medium |
| AB_003 | 長時間待機後 | 30分放置後 | データ抽出実行 | 正常に動作する | Low |

----------------------------------------------------------------

## 7. テスト実行優先順位

### 7.1 必須テスト（Priority 1）
- すべてのHighプライオリティテストケース
- 基本的なE2Eフロー（E2E_001, E2E_002, E2E_003）

### 7.2 推奨テスト（Priority 2）
- Mediumプライオリティテストケース
- 互換性テスト
- パフォーマンステスト

### 7.3 オプションテスト（Priority 3）
- Lowプライオリティテストケース

----------------------------------------------------------------

## 8. テスト終了条件

1. すべてのHighプライオリティテストケースが合格
2. Critical/Majorバグが0件
3. パフォーマンス基準を満たす

----------------------------------------------------------------

## 9. 変更履歴

### v2.0 (2025-07-21)
- 一覧ページ関連のテストケースを削除
- 詳細ページ専用のテストケースに更新
- エラーメッセージの統一

### v1.0 (2025-07-20)
- 初版作成